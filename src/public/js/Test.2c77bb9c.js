(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Test"],{"3b2b":function(t,e,s){var i=s("7726"),a=s("5dbc"),n=s("86cc").f,o=s("9093").f,l=s("aae3"),c=s("0bfb"),r=i.RegExp,u=r,m=r.prototype,d=/a/g,g=/a/g,f=new r(d)!==d;if(s("9e1e")&&(!f||s("79e5")(function(){return g[s("2b4c")("match")]=!1,r(d)!=d||r(g)==g||"/a/i"!=r(d,"i")}))){r=function(t,e){var s=this instanceof r,i=l(t),n=void 0===e;return!s&&i&&t.constructor===r&&n?t:a(f?new u(i&&!n?t.source:t,e):u((i=t instanceof r)?t.source:t,i&&n?c.call(t):e),s?this:m,r)};for(var p=function(t){t in r||n(r,t,{configurable:!0,get:function(){return u[t]},set:function(e){u[t]=e}})},h=o(u),v=0;h.length>v;)p(h[v++]);m.constructor=r,r.prototype=m,s("2aba")(i,"RegExp",r)}s("7a56")("RegExp")},"4c0b":function(t,e,s){"use strict";e["a"]=function(t){var e=new Date(t),s=e.getFullYear(),i=e.getMonth()+1,a=e.getDay(),n=e.getHours(),o=e.getMinutes();return i<10&&(i="0"+i),a<10&&(a="0"+a),n<10&&(n="0"+n),o<10&&(o="0"+o),"".concat(s,"-").concat(i,"-").concat(a," ").concat(n,":").concat(o)}},5488:function(t,e,s){"use strict";var i=s("c2cb"),a=s.n(i);a.a},"5a9c":function(t,e,s){},"8bc8":function(t,e,s){"use strict";var i=s("5a9c"),a=s.n(i);a.a},aae3:function(t,e,s){var i=s("d3f4"),a=s("2d95"),n=s("2b4c")("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[n])?!!e:"RegExp"==a(t))}},ba09:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"flex-row"},[t.isAuthor?s("sidebar",{attrs:{tabs:t.tabs,active:t.active},on:{click:t.toClickTab}}):t._e(),s("div",{staticClass:"flex-1 flex-column"},["info"!==t.tabs[t.active].component||t.loading?"settings"===t.tabs[t.active].component&&!t.loading&&t.isAuthor?s("settings",{staticClass:"flex-1",attrs:{title:t.title},on:{save:t.toSave}}):"submissions"===t.tabs[t.active].component&&!t.loading&&t.isAuthor?s("submissions",{staticClass:"flex-1",attrs:{title:t.title}}):t._e():s("info",{staticClass:"flex-1",attrs:{test:t.test,flag:t.comment.flag},on:{comment:t.toComment}})],1)],1)},a=[],n=(s("a481"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex-row pd-1 settings"},[s("form",{staticClass:"w-50 flex-column pure-form pure-form-stacked settings-form"},[s("div",{staticClass:"form-group"},[s("span",[t._v("访问限制")]),s("label",{staticClass:"pure-radio",attrs:{for:"public"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.settings.accessbility,expression:"settings.accessbility"}],attrs:{type:"radio",id:"public",name:"accessbility"},domProps:{value:0,checked:t._q(t.settings.accessbility,0)},on:{change:function(e){t.$set(t.settings,"accessbility",0)}}}),t._v("\r\n        公开\r\n      ")]),s("label",{staticClass:"pure-radio",attrs:{for:"private"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.settings.accessbility,expression:"settings.accessbility"}],attrs:{type:"radio",id:"private",name:"accessbility"},domProps:{value:1,checked:t._q(t.settings.accessbility,1)},on:{change:function(e){t.$set(t.settings,"accessbility",1)}}}),t._v("\r\n        私有\r\n      ")]),0===t.settings.accessbility?s("span",{staticClass:"pure-form-message"},[t._v("\r\n        允许任何人访问\r\n      ")]):s("span",{staticClass:"pure-form-message"},[t._v("\r\n        只允许指定用户访问\r\n      ")])]),s("div",{staticClass:"form-group"},[s("span",[t._v("时间限制")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.settings.timeLimit.minutes,expression:"settings.timeLimit.minutes"}],attrs:{type:"number"},domProps:{value:t.settings.timeLimit.minutes},on:{input:function(e){e.target.composing||t.$set(t.settings.timeLimit,"minutes",e.target.value)}}}),s("span",{staticClass:"pure-form-message"},[t._v("\r\n        分\r\n      ")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.settings.timeLimit.seconds,expression:"settings.timeLimit.seconds"}],attrs:{type:"number"},domProps:{value:t.settings.timeLimit.seconds},on:{input:function(e){e.target.composing||t.$set(t.settings.timeLimit,"seconds",e.target.value)}}}),s("span",{staticClass:"pure-form-message"},[t._v("\r\n        秒\r\n      ")])]),s("div",{staticClass:"form-group"},[s("span",[t._v("计时方式")]),s("label",{attrs:{for:"timerMode1"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.settings.timerMode,expression:"settings.timerMode"}],attrs:{type:"radio",name:"timerMode",id:"timerMode1"},domProps:{value:0,checked:t._q(t.settings.timerMode,0)},on:{change:function(e){t.$set(t.settings,"timerMode",0)}}}),t._v("\r\n        单个问题\r\n      ")]),s("label",{attrs:{for:"timerMode2"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.settings.timerMode,expression:"settings.timerMode"}],attrs:{type:"radio",name:"timerMode",id:"timerMode2"},domProps:{value:1,checked:t._q(t.settings.timerMode,1)},on:{change:function(e){t.$set(t.settings,"timerMode",1)}}}),t._v("\r\n        所有问题\r\n      ")]),0===t.settings.timerMode?s("span",{staticClass:"pure-form-message"},[t._v("\r\n        在限定时间内回答一个问题\r\n      ")]):s("span",{staticClass:"pure-form-message"},[t._v("\r\n        在限定时间内回答所有问题\r\n      ")])]),s("div",{staticClass:"form-group"},[s("span",[t._v("开放时间")]),s("label",{attrs:{for:"schedule-on"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.settings.schedule,expression:"settings.schedule"}],attrs:{type:"radio",name:"schedule",id:"schedule-on"},domProps:{value:0,checked:t._q(t.settings.schedule,0)},on:{change:function(e){t.$set(t.settings,"schedule",0)}}}),t._v("\r\n        不限制\r\n      ")]),s("label",{attrs:{for:"schedule-off"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.settings.schedule,expression:"settings.schedule"}],attrs:{type:"radio",name:"schedule",id:"schedule-off"},domProps:{value:1,checked:t._q(t.settings.schedule,1)},on:{change:function(e){t.$set(t.settings,"schedule",1)}}}),t._v("\r\n        在特定时间开放\r\n      ")]),0===t.settings.schedule?s("span",{staticClass:"pure-form-message"},[t._v("\r\n        测试可以在任何时间进行\r\n      ")]):s("span",{staticClass:"pure-form-message"},[t._v("\r\n        测试只能在指定时间进行\r\n      ")])]),t.settings.schedule?s("div",{staticClass:"form-group"},[s("span",{staticClass:"form-group-label"},[t._v("测试开放时间")]),s("div",{staticClass:"pure-g"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.settings.date,expression:"settings.date"}],attrs:{type:"date",id:"scheduleDate",required:""},domProps:{value:t.settings.date},on:{input:function(e){e.target.composing||t.$set(t.settings,"date",e.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:t.settings.time,expression:"settings.time"}],attrs:{type:"time",id:"scheduleTime",required:""},domProps:{value:t.settings.time},on:{input:function(e){e.target.composing||t.$set(t.settings,"time",e.target.value)}}})])]):t._e(),s("div",{staticClass:"ml-auto mt-auto flex-row"},[s("button",{staticClass:"pure-button",attrs:{disabled:t.flag},on:{click:function(e){return e.preventDefault(),t.reset(e)}}},[t._v("Reset")]),s("button",{staticClass:"ml-1 pure-button pure-button-primary",attrs:{disabled:t.flag},on:{click:function(e){return e.preventDefault(),t.save(e)}}},[t._v("\r\n        Save\r\n      ")]),s("button",{staticClass:"ml-1 pure-button button-error",attrs:{disabled:t.flag},on:{click:function(e){return e.preventDefault(),t.del(e)}}},[t._v("\r\n        Delete\r\n      ")])])]),1===t.settings.accessbility?s("whitelist",{staticClass:"flex-1",attrs:{list:t.settings.whitelist},on:{"add-mail":t.toAddMail,"del-mail":t.toDelMail}}):t._e()],1)}),o=[],l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"whitelist bd-1 shadow-1"},[s("div",{staticClass:"flex-row pure-form whitelist-header"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],attrs:{type:"text",id:"whitelist-search",placeholder:"Search"},domProps:{value:t.keyword},on:{input:function(e){e.target.composing||(t.keyword=e.target.value)}}}),s("label",{staticClass:"ml-auto",attrs:{for:"whitelist-selectall"}},[t._v("\n      全选\n      "),s("input",{attrs:{type:"checkbox",id:"whitelist-selectall"},on:{change:t.selectAll}})]),s("button",{staticClass:"pure-button pure-button-primary ml-1",on:{click:function(e){return e.preventDefault(),t.sendMail(e)}}},[t._v("发送邀请")])]),s("div",{staticClass:"whitelist-body"},[s("form",{staticClass:"mt-1 flex-row pure-form"},[s("div",{staticClass:"pure-control-group ml-auto"},[s("input",{attrs:{type:"email",placeholder:"Email",id:"email",required:""}}),s("button",{staticClass:"pure-button ml-1",on:{click:function(e){return e.preventDefault(),t.addEmail(e)}}},[t._v("+ 添加")])])]),s("ul",{staticClass:"mt-1"},t._l(t.filterdMails,function(e,i){return s("li",{key:e,staticClass:"flex-row mt-1"},[s("label",{staticClass:"flex-1  flex-item-center ml-1"},[s("input",{staticClass:"mail-checkbox",attrs:{type:"checkbox"}}),t._v("\n          "+t._s(e)+"\n        ")]),s("button",{staticClass:"pure-button button-error",on:{click:function(e){e.preventDefault(),t.delEmail(i)}}},[t._v("删除")])])}))])])},c=[],r=(s("3b2b"),{props:{list:{type:Array,default:[]}},computed:{filterdMails:function(){if(!this.keyword)return this.list;var t=new RegExp(this.keyword);return this.list.filter(function(e){return t.test(e)})}},data:function(){return{keyword:""}},methods:{selectAll:function(t){var e=t.target;if(e.checked)for(var s=document.getElementsByClassName("mail-checkbox"),i=0;i<s.length;i+=1)s[i].checked=!0;else for(var a=document.getElementsByClassName("mail-checkbox"),n=0;n<a.length;n+=1)a[n].checked=!1},sendMail:function(){var t=this;this.$axios.post("".concat(this.$url.sendmail,"/turing%20test")).then(function(){t.$alert("success","send mail success.")}).catch(console.log)},addEmail:function(){var t=document.getElementById("email");if(t.checkValidity())this.$emit("add-mail",t.value);else{var e=document.createElement("button");t.appendChild(e),e.click(),t.removeChild(e)}},delEmail:function(t){this.$emit("del-mail",t)}}}),u=r,m=(s("8bc8"),s("2877")),d=Object(m["a"])(u,l,c,!1,null,"0bbe8d12",null);d.options.__file="white-list.vue";var g=d.exports,f={components:{Whitelist:g},props:{title:{type:String}},data:function(){return{settings:{accessbility:0,timeLimit:{minutes:0,seconds:10},timerMode:0,whitelist:[],schedule:0,scheduleAt:0,date:0,time:0},flag:!1}},mounted:function(){var t;this.title&&(t=JSON.parse(localStorage.getItem("".concat(this.title,"-settings")))),t&&(this.settings=t)},methods:{toAddMail:function(t){-1===this.settings.whitelist.indexOf(t.toLowerCase())&&this.settings.whitelist.push(t.toLowerCase())},toDelMail:function(t){this.settings.whitelist.splice(t,1)},save:function(){var t=this;if(!this.flag){if(this.flag=!0,this.settings.schedule){var e=document.getElementById("scheduleDate"),s=document.getElementById("scheduleTime");if(e.checkValidity()&&s.checkValidity()){var i="".concat(e.value," ").concat(s.value),a=new Date(i).getTime();this.settings.scheduleAt=a}}localStorage.setItem("".concat(this.title,"-settings"),JSON.stringify(this.settings)),this.$axios.put("".concat(this.$url.tests,"/").concat(this.title),{settings:this.settings}).then(function(){t.$alert("success","Saved"),t.flag=!1}).catch(function(){t.flag=!1})}},reset:function(){if(!this.flag){this.flag=!0;var t=JSON.parse(localStorage.getItem("".concat(this.title,"-settings")));t&&(this.settings=t),this.flag=!1}},del:function(){var t=this;this.flag||(this.flag=!0,this.$axios.delete("".concat(this.$url.tests,"/").concat(this.title)).then(function(e){t.flag=!1,e.data.ok&&(t.$alert("success","删除成功!"),setTimeout(function(){t.$router.replace("/")},300))}).catch(function(){t.flag=!1}))}}},p=f,h=Object(m["a"])(p,n,o,!1,null,null,null);h.options.__file="index.vue";var v=h.exports,b=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"test"},[s("div",{staticClass:"flex-row"},[s("h1",{staticClass:"test__title"},[t._v(t._s(t.test.title))]),s("button",{staticClass:"ml-auto pure-button pure-button-primary flex-item-center"},[s("a",{attrs:{href:"/testing/"+t.test.title,target:"_blank"}},[t._v("\n        Start Test\n      ")])])]),s("div",{staticClass:"flex-row"},[s("ul",{staticClass:"meta-list"},[s("li",{staticClass:"meta-list__item"},[s("span",{staticClass:"meta-list__item-key"},[t._v("作者")]),s("span",{staticClass:"meta-list__item-value"},[t._v(t._s(t.test.author))])]),s("li",{staticClass:"meta-list__item"},[s("span",{staticClass:"meta-list__item-key"},[t._v("创建时间")]),s("span",{staticClass:"meta-list__item-value"},[t._v(t._s(t._f("formatDateTime")(t.test.createdAt)))])]),s("li",{staticClass:"meta-list__item"},[s("span",{staticClass:"meta-list__item-key"},[t._v("评分")]),s("star",{staticClass:"meta-list__item-value",attrs:{disable:t.test.vote.disable,count:6-t.test.vote.count},on:{click:t.toVote}})],1),s("li",{staticClass:"meta-list__item"},[s("span",{staticClass:"meta-list__item-key"},[t._v("标签")]),s("span",{staticClass:"meta-list__item-value tag-list"},t._l(t.test.tags,function(t){return s("tag",{key:t,staticClass:"mr-1 mb-1",attrs:{text:t}})}))])]),s("rating",{staticClass:"ml-auto",attrs:{data:t.test.rating}})],1),s("p",{staticClass:"test__intro"},[t._v(t._s(t.test.intro))]),s("ot-comment",{attrs:{data:t.test.comments,flag:t.flag},on:{submit:t.toComment}})],1)},_=[],C={props:{test:{type:Object,required:!0},flag:{type:Boolean,default:!1}},data:function(){return{vote:{disable:!1,count:0}}},methods:{toComment:function(t){this.$emit("comment",t)},toVote:function(t){window.$user?(this.test.vote.disable=!0,this.test.vote.count=t,this.$axios.put("".concat(this.$url.stars,"/").concat(this.test.title),{count:t}).then(console.log).catch(console.log)):this.alert("error","請先登錄")}}},y=C,w=(s("5488"),Object(m["a"])(y,b,_,!1,null,"4d0be4fa",null));w.options.__file="index.vue";var x=w.exports,k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("list",{attrs:{list:t.list,total:t.total,loading:t.loading,page:t.page},on:{click:t.toPage}})},$=[],M=(s("cadf"),s("551c"),s("097d"),s("4c0b")),E={props:{title:{type:String,required:!0}},data:function(){return{results:[],total:0,page:1,loading:!0}},computed:{list:function(){return this.results.map(function(t){return{content:"".concat(t.title," - ").concat(t.username," - ").concat(Object(M["a"])(t.createdAt)),to:"/results/".concat(t._id)}})}},mounted:function(){this.getData()},methods:{toPage:function(t){this.page=t,this.getData()},getData:function(){var t=this;this.$axios.get("".concat(this.$url.results,"?title=").concat(this.title,"&page=").concat(this.page)).then(function(e){t.results=e.data.results,t.total=e.data.total,t.loading=!1}).catch(function(e){t.$alert("error",e.message),t.loading=!1})}}},S=E,D=Object(m["a"])(S,k,$,!1,null,null,null);D.options.__file="index.vue";var N=D.exports,A={components:{Info:x,Settings:v,Submissions:N},props:{title:{type:String,required:!0}},data:function(){return{tabs:[{name:"基础信息",component:"info"},{name:"设置",component:"settings"},{name:"测试记录",component:"submissions"}],active:0,loading:!0,isAuthor:!1,test:{},comment:{flag:!1},settings:{flag:!1}}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;this.$axios.get("".concat(this.$url.tests,"/").concat(this.title)).then(function(e){t.test=e.data,t.loading=!1,window.$user&&t.test.author===window.$user.username&&(t.isAuthor=!0,window.localStorage.setItem("".concat(t.title,"-settings"),JSON.stringify(t.test.settings)))}).catch(function(e){t.loading=!1,t.$alert("error",e.response.data),t.$router.replace("/")})},toClickTab:function(t){this.active=t},toComment:function(t){var e=this;this.comment.flag||(t.title=this.title,this.comment.flag=!0,this.$axios.post("".concat(this.$url.tests,"/").concat(this.title,"/comments"),t).then(function(t){e.test.comments.push(t.data),e.comment.flag=!1}).catch(function(){e.comment.flag=!1}))},toSave:function(t){var e=this;this.settings.flag||this.$axios.put("".concat(this.$url.tests,"/").concat(this.title),{settings:t}).then(function(){e.$alert("success","Saved"),e.settings.flag=!1}).catch(function(){e.settings.flag=!1})}},destroyed:function(){localStorage.removeItem("".concat(this.title,"-settings"))}},P=A,q=Object(m["a"])(P,i,a,!1,null,null,null);q.options.__file="index.vue";e["default"]=q.exports},c2cb:function(t,e,s){}}]);
//# sourceMappingURL=Test.2c77bb9c.js.map